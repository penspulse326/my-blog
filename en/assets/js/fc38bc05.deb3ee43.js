"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1491],{3949:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>o});var s=t(4848),a=t(8453);const r={title:"useReducer",description:"React \u7684 useReducer",date:new Date("2023-12-02T15:21:00.000Z"),keywords:["\u7a0b\u5f0f\u8a9e\u8a00","JavaScript","React","JSX","Hooks","useReducer"],slug:"react-tutorial-4"},c=void 0,i={id:"react/hooks/2023-12-02-react-useReducer",title:"useReducer",description:"React \u7684 useReducer",source:"@site/docs/react/hooks/2023-12-02-react-useReducer.md",sourceDirName:"react/hooks",slug:"/react/hooks/react-tutorial-4",permalink:"/en/react/hooks/react-tutorial-4",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"useReducer",description:"React \u7684 useReducer",date:"2023-12-02T15:21:00.000Z",keywords:["\u7a0b\u5f0f\u8a9e\u8a00","JavaScript","React","JSX","Hooks","useReducer"],slug:"react-tutorial-4"},sidebar:"tutorialSidebar",previous:{title:"useEffect",permalink:"/en/react/hooks/react-useeffect"},next:{title:"UI \u5143\u4ef6\u5927\u6311\u6230",permalink:"/en/category/ui-\u5143\u4ef6\u5927\u6311\u6230"}},d={},o=[{value:"\u8a2d\u5b9a",id:"\u8a2d\u5b9a",level:2},{value:"\u7528\u6cd5",id:"\u7528\u6cd5",level:2},{value:"\u512a\u5316",id:"\u512a\u5316",level:2},{value:"\u53c3\u8003\u8cc7\u6599",id:"\u53c3\u8003\u8cc7\u6599",level:2}];function l(e){const n={a:"a",br:"br",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["\u5728\u8981\u7ba1\u7406\u7684 state \u6162\u6162\u8b8a\u591a\u4e4b\u5f8c\u7ba1\u7406\u4e0a\u5c31\u6703\u8b8a\u5f97\u7e41\u7463\uff0c",(0,s.jsx)(n.br,{}),"\n","\u5728 React \u901a\u5e38\u53ef\u4ee5\u4f7f\u7528 useReducer \u505a\u7ba1\u7406\uff0c\u6709\u898f\u6a21\u4e00\u9ede\u7684\u5c08\u6848\u5c31\u6703\u6295\u5165 Redux\uff0c",(0,s.jsx)(n.br,{}),"\n","\u4f46\u5169\u8005\u7684\u8a9e\u6cd5\u8ddf\u6982\u5ff5\u7b97\u662f\u985e\u4f3c\u7684\uff01"]}),"\n",(0,s.jsx)(n.h2,{id:"\u8a2d\u5b9a",children:"\u8a2d\u5b9a"}),"\n",(0,s.jsx)(n.p,{children:"\u5047\u8a2d\u539f\u672c\u6709 data\u3001isLoading \u9019\u5169\u500b state\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const [data, setData] = useState([]);\nconst [isLoading, setIsLoading] = useState(true);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6539\u70ba\u7528 reducer \u7684\u65b9\u5f0f\u7ba1\u7406\u5f8c\uff0c\u9019\u4e9b state \u53ef\u4ee5\u62c9\u51fa\u4f86\u505a\u6210\u4e00\u500b\u5927\u7684 state\uff0c",(0,s.jsx)(n.br,{}),"\n","\u901a\u5e38\u4e5f\u6703\u5728\u6b64\u8ce6\u4e88\u521d\u59cb\u503c\uff0c\u6240\u4ee5\u8b8a\u6578\u540d\u7a31\u7fd2\u6163\u4e0a\u547d\u540d\u6210 initialState\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const initialState = {\n  data: [],\n  isLoading: true,\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u539f\u672c\u7528\u4f86\u6539\u8b8a\u90a3\u4e9b\u72c0\u614b\u7684 setAction \u65b9\u6cd5\uff0c\u4e00\u6a23\u8981\u62c9\u51fa\u4f86\u5b58\u5230 reducer \u9019\u500b\u8b8a\u6578\uff0c",(0,s.jsx)(n.br,{}),"\n","\u4e26\u4e14\u6539\u6210\u7528 switch \u4f86\u5224\u65b7\u6709\u54ea\u4e9b\u52d5\u4f5c\u53ef\u4ee5\u88ab\u89f8\u767c\uff0c \u53ef\u4ee5\u8aaa reducer \u662f\u5b9a\u7fa9\u52d5\u4f5c\u7684\u5730\u65b9\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'const reducer = (state, action) => {\n  switch (action.type) {\n    case "SET_LOADING":\n      return { ...state, isLoading: action.payload };\n    case "SET_DATA":\n      return { ...state, data: action.payload };\n    default:\n      return state;\n  }\n};\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u6bcf\u500b case \u505a\u7684\u4e8b\u8ddf\u539f\u672c\u7684 setAction \u5dee\u4e0d\u591a\uff0c",(0,s.jsx)(n.br,{}),"\n","\u5dee\u5225\u5728\u65bc\u50b3\u5165\u7684\u503c\u8981\u900f\u904e ",(0,s.jsx)(n.code,{children:"action.payload"})," \u53d6\u5f97\uff0c",(0,s.jsx)(n.br,{}),"\n","return \u4e4b\u524d\u4e5f\u53ef\u4ee5\u505a\u5176\u4ed6\u904b\u7b97\u3002"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\u7528\u6cd5",children:"\u7528\u6cd5"}),"\n",(0,s.jsxs)(n.p,{children:["\u72c0\u614b\u8ddf\u65b9\u6cd5\u90fd\u88ab\u5206\u96e2\u51fa\u4f86\u4e86\uff0c\u9019\u6642\u5c31\u53ef\u4ee5\u958b\u59cb\u4f7f\u7528 useReducer\uff0c",(0,s.jsx)(n.br,{}),"\n","\u628a\u525b\u525b\u5b9a\u7fa9\u597d\u7684 state \u8207 reducer \u50b3\u5165\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const MyComponent = () => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  console.log(state); // \u6703\u5370\u51fa initailState \u88e1\u9762\u7684\u6771\u897f\n\n  return (\n    <div>\n      {state.data.map((item) => (\n        <div>{item.name}</div>\n      ))}\n    </div>\n  );\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u539f\u672c\u8981\u4f7f\u7528 setAction \u89f8\u767c\u7684\u72c0\u614b\u8b8a\u66f4\uff0c\u9019\u6642\u8981\u6539\u7528 dispatch \u50b3\u5165\u5c0d\u61c9\u683c\u5f0f\uff0c",(0,s.jsx)(n.br,{}),"\n","type \u5c31\u662f\u6211\u5011\u525b\u525b\u5728 reducer \u88e1\u9762\u5b9a\u597d\u7684 case\uff0cpayload \u5c31\u662f\u8981\u50b3\u5165\u7684\u8cc7\u6599\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'dispatch({ type: "SET_LOADING", payload: false });\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\u512a\u5316",children:"\u512a\u5316"}),"\n",(0,s.jsxs)(n.p,{children:["\u6b64\u7bc7\u793a\u7bc4\u7684\u60c5\u5883\u662f\u5143\u4ef6\u521d\u6b21\u6e32\u67d3\u6642\u8981\u53bb\u6253 API\uff0c\u63a5\u5230\u56de\u4f86\u7684\u8cc7\u6599\u5f8c\uff0c",(0,s.jsx)(n.br,{}),"\n","\u6539\u8b8a isLoading \u548c data \u7684\u5167\u5bb9\uff0c\u6240\u4ee5\u7a0b\u5f0f\u78bc\u5927\u81f4\u7684\u7d50\u69cb\u6703\u662f\u9019\u6a23\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'const MyComponent = () => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const { isLoading, data } = state;\n\n  const fetchData = async () => {\n    try {\n      const response = await getData();\n      dispatch({ type: "SET_LOADING", payload: false });\n      dispatch({ type: "SET_DATA", payload: response.data });\n    } catch (err) {\n      console.error("Error:", err);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  return (\n    <div>\n      {isLoading && <LoadingAnimation />}\n      {data.map((item) => (\n        <div>{item.name}</div>\n      ))}\n    </div>\n  );\n};\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ef\u4ee5\u628a state \u88e1\u9762\u7684\u72c0\u614b\u8b8a\u6578\u90fd\u89e3\u69cb\u51fa\u4f86\u3002",(0,s.jsx)(n.br,{}),"\n","\u6539\u8b8a\u72c0\u614b\u7684\u65b9\u5f0f\u5f9e setAction \u6539\u70ba dispatch \u5f8c\uff0c",(0,s.jsx)(n.br,{}),"\n","\u9019\u6a23\u7684\u683c\u5f0f",(0,s.jsx)(n.code,{children:'{ type: "SET_LOADING", payload: false }'})," \u8b93\u8a9e\u6cd5\u770b\u8d77\u4f86\u8b8a\u9577\u4e86\uff0c",(0,s.jsx)(n.br,{}),"\n","\u5982\u679c\u9047\u5230\u6709\u8981\u628a\u65b9\u6cd5\u50b3\u905e\u4e0b\u53bb\u7684\u72c0\u6cc1\uff0c\u6700\u597d\u518d\u5c01\u88dd\u6210\u4e00\u500b\u51fd\u5f0f\uff0c",(0,s.jsx)(n.br,{}),"\n","\u6240\u4ee5\u539f\u672c\u76f4\u63a5\u5beb setXXX \u76f4\u63a5\u50b3\u4e0b\u53bb\u7684 props \u4e5f\u5efa\u8b70\u6539\u70ba\u66f4\u8a9e\u610f\u5316\u7684 on \u4e8b\u4ef6\uff0c",(0,s.jsx)(n.br,{}),"\n","\u5426\u5247\u639b\u5728 component \u4e0a\u7684 callback \u6703\u5f88\u9577\u4e5f\u4e0d\u597d\u95b1\u8b80\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'const handleChange = () => {\n  dispatch({ type: "SET_LOADING", payload: false });\n};\n\nreturn <ChildComponent onChange={handleChange} />;\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u6700\u5f8c\u5c31\u662f\uff0caction type \u76ee\u524d\u5168\u90e8\u90fd\u662f\u7528\u5b57\u4e32\u50b3\u4e0b\u53bb\u7684\uff0c",(0,s.jsx)(n.br,{}),"\n","\u5982\u679c\u5b57\u4e32\u6709\u6253\u932f\u7684\u8a71\u7b2c\u4e00\u6642\u9593\u6c92\u5831\u932f\u5c31\u5f88\u96e3\u6293\u5230 bug\uff0c",(0,s.jsx)(n.br,{}),"\n","\u6240\u4ee5\u9019\u4e9b\u5b57\u4e32\u901a\u5e38\u6703\u62c9\u51fa\u4f86\u8b8a\u6210\u8b8a\u6578\u540d\u7a31\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'const ACTION = {\n  SET_LOADING: "SET_LOADING",\n  SET_DATA: "SET_DATA",\n};\n\n// \u6539\u6210\u8b8a\u6578\u5f8c\u80fd\u964d\u4f4e\u51fa\u5305\u7387\ndispatch({ type: ACTION.SET_LOADING, payload: false });\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\u53c3\u8003\u8cc7\u6599",children:"\u53c3\u8003\u8cc7\u6599"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://medium.com/%E6%89%8B%E5%AF%AB%E7%AD%86%E8%A8%98/react-hooks-usestate-vs-usereducer-b14966ad37dd",children:"\u65e2\u751f useState \u4f55\u751f useReducer ?"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://ithelp.ithome.com.tw/articles/10268258",children:"Day6-React Hook \u7bc7-useReducer"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>i});var s=t(6540);const a={},r=s.createContext(a);function c(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);